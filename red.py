
from matplotlib.colors import ListedColormap
from numpy import nan, inf

# Used to reconstruct the colormap in viscm
parameters = {'xp': [11.890960615721497, 23.822378188689413, 29.167229045755136, 25.603995141044663, 15.983263598326346, 6.0062086651369668, 0.7326184265610607, 2.5923421247544525],
              'yp': [-10.622564647538042, -9.4832925206794698, -4.4947650540847803, 5.1259664886335372, 13.677727859938699, 15.103021421822888, 9.21448813319168, -4.113531703861099],
              'min_Jp': 10.208333333333336,
              'max_Jp': 94.89583333333334}

cm_data = [[ 0.13217294, 0.02216185, 0.15925166],
           [ 0.13700895, 0.02397117, 0.1629548 ],
           [ 0.14184242, 0.02582052, 0.16663224],
           [ 0.14667435, 0.02770828, 0.17028396],
           [ 0.1515118 , 0.0296255 , 0.17391084],
           [ 0.15634822, 0.03157918, 0.17751147],
           [ 0.16118403, 0.0335684 , 0.18108571],
           [ 0.16602694, 0.03558282, 0.18463423],
           [ 0.17087022, 0.03763038, 0.18815582],
           [ 0.17571416, 0.03971038, 0.19165023],
           [ 0.18056413, 0.04177911, 0.19511759],
           [ 0.18541748, 0.04380573, 0.19855723],
           [ 0.19027255, 0.04580292, 0.20196864],
           [ 0.19513086, 0.04777046, 0.20535151],
           [ 0.19999678, 0.04970423, 0.20870545],
           [ 0.20486526, 0.05161264, 0.21202979],
           [ 0.20973655, 0.05349683, 0.21532404],
           [ 0.2146126 , 0.05535565, 0.21858765],
           [ 0.21949599, 0.05718708, 0.22181983],
           [ 0.22438271, 0.0589977 , 0.22502005],
           [ 0.22927295, 0.06078852, 0.22818767],
           [ 0.23416685, 0.06256055, 0.23132199],
           [ 0.23906848, 0.06430962, 0.23442174],
           [ 0.24397469, 0.066041  , 0.23748637],
           [ 0.24888461, 0.06775691, 0.24051513],
           [ 0.25379827, 0.06945839, 0.24350711],
           [ 0.25871566, 0.07114651, 0.24646137],
           [ 0.26363742, 0.07282147, 0.24937673],
           [ 0.26856539, 0.07448193, 0.25225155],
           [ 0.27349652, 0.07613287, 0.25508536],
           [ 0.2784306 , 0.07777555, 0.25787701],
           [ 0.28336738, 0.07941129, 0.26062529],
           [ 0.28830657, 0.0810415 , 0.26332894],
           [ 0.29324781, 0.08266765, 0.26598665],
           [ 0.29819066, 0.0842913 , 0.26859707],
           [ 0.30313462, 0.08591411, 0.27115881],
           [ 0.30807913, 0.08753781, 0.27367046],
           [ 0.31302354, 0.08916428, 0.27613055],
           [ 0.3179671 , 0.09079548, 0.27853761],
           [ 0.32290901, 0.09243347, 0.28089018],
           [ 0.32784834, 0.09408045, 0.28318676],
           [ 0.3327841 , 0.09573871, 0.28542589],
           [ 0.33771517, 0.09741068, 0.28760614],
           [ 0.34264037, 0.09909887, 0.28972611],
           [ 0.3475584 , 0.10080588, 0.29178446],
           [ 0.35246787, 0.10253444, 0.29377994],
           [ 0.35736729, 0.1042873 , 0.29571139],
           [ 0.36225509, 0.10606732, 0.29757777],
           [ 0.36712963, 0.10787737, 0.29937817],
           [ 0.37198917, 0.10972035, 0.30111186],
           [ 0.37683191, 0.11159915, 0.30277826],
           [ 0.38165602, 0.11351661, 0.30437704],
           [ 0.38646115, 0.11547391, 0.30590595],
           [ 0.39124378, 0.11747551, 0.30736703],
           [ 0.39600185, 0.11952408, 0.30876081],
           [ 0.40073345, 0.12162204, 0.31008796],
           [ 0.40543666, 0.12377161, 0.31134945],
           [ 0.41011068, 0.12597382, 0.31254458],
           [ 0.41475257, 0.12823152, 0.31367675],
           [ 0.41936048, 0.13054631, 0.31474813],
           [ 0.42393283, 0.1329193 , 0.31576082],
           [ 0.42846863, 0.13535097, 0.31671606],
           [ 0.43296602, 0.13784226, 0.31761764],
           [ 0.43742369, 0.14039343, 0.31846874],
           [ 0.44184069, 0.14300431, 0.31927234],
           [ 0.44621628, 0.14567436, 0.32003134],
           [ 0.45054959, 0.14840295, 0.3207497 ],
           [ 0.4548402 , 0.15118901, 0.32143072],
           [ 0.45908777, 0.15403127, 0.32207797],
           [ 0.46329209, 0.15692823, 0.32269527],
           [ 0.46745333, 0.15987816, 0.32328556],
           [ 0.47157168, 0.16287923, 0.32385203],
           [ 0.47564729, 0.16592949, 0.32439886],
           [ 0.4796807 , 0.16902687, 0.32492888],
           [ 0.48367255, 0.17216931, 0.32544435],
           [ 0.48762348, 0.17535473, 0.32594799],
           [ 0.49153407, 0.17858094, 0.32644367],
           [ 0.49540516, 0.18184585, 0.32693356],
           [ 0.49923765, 0.18514753, 0.32741901],
           [ 0.50303238, 0.18848404, 0.32790211],
           [ 0.50679021, 0.1918535 , 0.3283848 ],
           [ 0.51051197, 0.19525372, 0.32887115],
           [ 0.51419864, 0.19868332, 0.3293606 ],
           [ 0.5178511 , 0.20214066, 0.32985463],
           [ 0.5214702 , 0.20562424, 0.33035461],
           [ 0.52505679, 0.20913259, 0.33086184],
           [ 0.52861174, 0.21266422, 0.33137813],
           [ 0.53213591, 0.21621771, 0.33190506],
           [ 0.53563003, 0.21979219, 0.33244233],
           [ 0.53909486, 0.22338655, 0.33299082],
           [ 0.54253112, 0.22699981, 0.33355133],
           [ 0.54593951, 0.23063103, 0.3341246 ],
           [ 0.54932069, 0.23427936, 0.3347113 ],
           [ 0.5526753 , 0.23794401, 0.33531204],
           [ 0.55600401, 0.24162409, 0.33592792],
           [ 0.55930743, 0.24531896, 0.33655939],
           [ 0.562586  , 0.24902819, 0.33720636],
           [ 0.56584023, 0.25275124, 0.33786925],
           [ 0.56907061, 0.25648762, 0.33854849],
           [ 0.57227758, 0.26023689, 0.33924447],
           [ 0.57546158, 0.26399864, 0.33995756],
           [ 0.57862299, 0.26777252, 0.34068809],
           [ 0.58176219, 0.27155821, 0.34143641],
           [ 0.58487952, 0.27535541, 0.34220284],
           [ 0.5879753 , 0.27916387, 0.34298768],
           [ 0.59104982, 0.28298338, 0.34379124],
           [ 0.59410335, 0.28681373, 0.34461383],
           [ 0.59713614, 0.29065476, 0.34545573],
           [ 0.60014841, 0.29450632, 0.34631724],
           [ 0.60314036, 0.2983683 , 0.34719867],
           [ 0.60611217, 0.30224059, 0.34810032],
           [ 0.60906401, 0.3061231 , 0.3490225 ],
           [ 0.61199602, 0.31001579, 0.34996551],
           [ 0.61490833, 0.31391855, 0.35092977],
           [ 0.61780102, 0.31783141, 0.35191549],
           [ 0.62067418, 0.32175435, 0.35292304],
           [ 0.62352785, 0.32568736, 0.35395276],
           [ 0.62636211, 0.32963045, 0.35500503],
           [ 0.62917696, 0.33358362, 0.35608024],
           [ 0.63197243, 0.33754692, 0.35717879],
           [ 0.63474851, 0.34152038, 0.35830109],
           [ 0.63750519, 0.34550404, 0.35944759],
           [ 0.64024242, 0.34949796, 0.36061874],
           [ 0.64296016, 0.35350219, 0.361815  ],
           [ 0.64565835, 0.35751681, 0.36303689],
           [ 0.64833689, 0.36154189, 0.36428491],
           [ 0.65099569, 0.36557751, 0.36555962],
           [ 0.65363464, 0.36962375, 0.36686156],
           [ 0.65625362, 0.37368071, 0.36819134],
           [ 0.65885249, 0.37774847, 0.36954958],
           [ 0.66143108, 0.38182714, 0.37093691],
           [ 0.66398925, 0.38591681, 0.37235401],
           [ 0.6665268 , 0.39001759, 0.37380159],
           [ 0.66904354, 0.39412957, 0.37528038],
           [ 0.67153927, 0.39825288, 0.37679116],
           [ 0.67401376, 0.4023876 , 0.37833471],
           [ 0.67646679, 0.40653386, 0.37991189],
           [ 0.67889811, 0.41069175, 0.38152357],
           [ 0.68130747, 0.41486139, 0.38317065],
           [ 0.68369461, 0.41904288, 0.38485409],
           [ 0.68605926, 0.42323632, 0.38657489],
           [ 0.68840112, 0.42744182, 0.38833408],
           [ 0.69071991, 0.43165947, 0.39013274],
           [ 0.69301532, 0.43588936, 0.391972  ],
           [ 0.69528706, 0.44013158, 0.39385302],
           [ 0.69753481, 0.44438622, 0.39577702],
           [ 0.69975825, 0.44865335, 0.39774529],
           [ 0.70195707, 0.45293303, 0.39975913],
           [ 0.70413095, 0.45722533, 0.40181991],
           [ 0.70627956, 0.4615303 , 0.40392907],
           [ 0.70840258, 0.46584796, 0.40608808],
           [ 0.71049972, 0.47017835, 0.40829848],
           [ 0.71257065, 0.47452147, 0.41056186],
           [ 0.71461509, 0.47887732, 0.41287986],
           [ 0.71663275, 0.48324588, 0.41525419],
           [ 0.71862297, 0.48762736, 0.41768646],
           [ 0.72058564, 0.49202161, 0.42017857],
           [ 0.72252072, 0.49642841, 0.42273247],
           [ 0.72442801, 0.50084764, 0.42535009],
           [ 0.72630736, 0.50527917, 0.4280334 ],
           [ 0.72815865, 0.50972283, 0.43078444],
           [ 0.72998179, 0.51417841, 0.43360527],
           [ 0.73177676, 0.51864568, 0.43649801],
           [ 0.7335436 , 0.52312435, 0.43946479],
           [ 0.735282  , 0.52761436, 0.44250776],
           [ 0.73699173, 0.53211558, 0.44562917],
           [ 0.7386738 , 0.53662714, 0.44883126],
           [ 0.74032856, 0.54114859, 0.45211624],
           [ 0.74195646, 0.54567942, 0.45548629],
           [ 0.74355806, 0.55021908, 0.45894356],
           [ 0.74513402, 0.55476696, 0.46249018],
           [ 0.74668392, 0.55932305, 0.46612847],
           [ 0.74820985, 0.56388599, 0.46986023],
           [ 0.74971304, 0.56845492, 0.47368731],
           [ 0.75119474, 0.57302898, 0.47761143],
           [ 0.75265634, 0.57760727, 0.4816342 ],
           [ 0.75409875, 0.5821892 , 0.48575729],
           [ 0.75552413, 0.5867735 , 0.48998183],
           [ 0.75693484, 0.5913589 , 0.49430861],
           [ 0.75833299, 0.59594428, 0.49873836],
           [ 0.75972082, 0.60052852, 0.50327153],
           [ 0.76110049, 0.60511055, 0.50790844],
           [ 0.76247511, 0.60968894, 0.51264863],
           [ 0.76384745, 0.61426246, 0.51749154],
           [ 0.76522033, 0.61882991, 0.52243633],
           [ 0.76659687, 0.62339002, 0.52748166],
           [ 0.76798065, 0.62794139, 0.53262551],
           [ 0.76937438, 0.63248306, 0.5378662 ],
           [ 0.77078116, 0.63701395, 0.54320147],
           [ 0.77220406, 0.64153305, 0.54862874],
           [ 0.77364697, 0.6460391 , 0.5541444 ],
           [ 0.77511333, 0.65053107, 0.55974478],
           [ 0.77660514, 0.65500859, 0.56542728],
           [ 0.77812521, 0.65947097, 0.57118833],
           [ 0.7796762 , 0.66391768, 0.57702413],
           [ 0.78126065, 0.66834823, 0.5829308 ],
           [ 0.78288225, 0.67276178, 0.58890278],
           [ 0.78454283, 0.67715824, 0.59493629],
           [ 0.78624341, 0.68153782, 0.60102834],
           [ 0.78798574, 0.68590048, 0.60717492],
           [ 0.78977136, 0.6902463 , 0.61337208],
           [ 0.79160163, 0.69457543, 0.61961594],
           [ 0.79347767, 0.69888812, 0.62590272],
           [ 0.79540044, 0.70318468, 0.63222879],
           [ 0.79737069, 0.70746552, 0.63859062],
           [ 0.79938896, 0.7117311 , 0.64498489],
           [ 0.80145565, 0.71598194, 0.65140842],
           [ 0.80357096, 0.72021863, 0.65785821],
           [ 0.80573492, 0.72444181, 0.66433145],
           [ 0.80794743, 0.72865214, 0.67082553],
           [ 0.81020822, 0.73285034, 0.67733802],
           [ 0.81251688, 0.73703717, 0.68386665],
           [ 0.81487287, 0.74121341, 0.69040936],
           [ 0.81727552, 0.74537988, 0.69696425],
           [ 0.81972401, 0.74953743, 0.70352957],
           [ 0.82221741, 0.75368694, 0.71010372],
           [ 0.82475466, 0.75782934, 0.71668525],
           [ 0.82733453, 0.76196557, 0.72327278],
           [ 0.82995566, 0.76609664, 0.72986505],
           [ 0.8326186 , 0.77022317, 0.73645634],
           [ 0.83532106, 0.77434644, 0.74304649],
           [ 0.83805986, 0.77846794, 0.74963694],
           [ 0.84083288, 0.78258896, 0.75622633],
           [ 0.84363782, 0.7867109 , 0.76281304],
           [ 0.84647214, 0.79083528, 0.76939511],
           [ 0.84933715, 0.79496296, 0.77596076],
           [ 0.85222705, 0.79909626, 0.78251384],
           [ 0.85513848, 0.80323709, 0.78905175],
           [ 0.85806918, 0.80738718, 0.79556899],
           [ 0.86101987, 0.81154768, 0.80205356],
           [ 0.8639918 , 0.81571948, 0.80849383],
           [ 0.86698336, 0.8199037 , 0.81488769],
           [ 0.86999889, 0.82409988, 0.82122435],
           [ 0.87304914, 0.82830561, 0.82748581],
           [ 0.87614321, 0.83251804, 0.83366558],
           [ 0.87928992, 0.83673363, 0.83976506],
           [ 0.88250184, 0.84094754, 0.84578322],
           [ 0.88579345, 0.8451544 , 0.8517168 ],
           [ 0.88916614, 0.84935152, 0.8575889 ],
           [ 0.89262301, 0.85353636, 0.86341425],
           [ 0.89616775, 0.85770724, 0.869197  ],
           [ 0.89979164, 0.86186514, 0.87496455],
           [ 0.90348888, 0.86601114, 0.88073164],
           [ 0.90725641, 0.87014684, 0.88649712],
           [ 0.91108357, 0.87427446, 0.89228319],
           [ 0.91496472, 0.87839598, 0.89809511],
           [ 0.91889606, 0.88251355, 0.90392883],
           [ 0.92287029, 0.88662863, 0.90980029],
           [ 0.92688468, 0.89074298, 0.91570505],
           [ 0.93093586, 0.89485797, 0.92164458],
           [ 0.93501995, 0.89897429, 0.92762868],
           [ 0.93913668, 0.90309373, 0.93364307],
           [ 0.94328257, 0.9072163 , 0.93970232],
           [ 0.94745686, 0.91134298, 0.94580127],
           [ 0.95165869, 0.91547459, 0.95193708],
           [ 0.95588623, 0.91961077, 0.95812116]]

test_cm = ListedColormap(cm_data, name=__file__)


if __name__ == "__main__":
    import matplotlib.pyplot as plt
    import numpy as np

    try:
        from viscm import viscm
        viscm(test_cm)
    except ImportError:
        print("viscm not found, falling back on simple display")
        plt.imshow(np.linspace(0, 100, 256)[None, :], aspect='auto',
                   cmap=test_cm)
    plt.show()
